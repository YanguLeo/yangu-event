!function(a){function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return a[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var e={};t.m=a,t.c=e,t.d=function(a,e,n){t.o(a,e)||Object.defineProperty(a,e,{configurable:!1,enumerable:!0,get:n})},t.n=function(a){var e=a&&a.__esModule?function(){return a.default}:function(){return a};return t.d(e,"a",e),e},t.o=function(a,t){return Object.prototype.hasOwnProperty.call(a,t)},t.p="scripts/",t(t.s=208)}({15:function(a,t){function e(){var a=document.createElement("input");return a.setAttribute("type","range"),"range"===a.type}a.exports=e},16:function(a,t){angular.module("campaign").run(["$templateCache",function(a){a.put("frontend/views/campaign/base/boost.html",'<a id="close" role="button" tabindex="0" aria-label="{{closeLabel}}" ng-click="c.failureAndClose();">&times;</a>\n<div id="logo" title="Survey Logo" role="image" aria-label="logo"></div>\n<h1>{{campaign.data.title}}</h1>\n<p ng-if="!(campaign.data.html && state.allowHtml)" class="nl main">{{ campaign.data.text || \'&nbsp;\' }}</p>\n<p ng-bind-html="campaign.data.text | trustHtml" ng-if="state.allowHtml && campaign.data.html" class="main"></p>\n<div class="button">\n    <button id="button" ng-click="c.feedback()">{{campaign.data.buttonText}}</button>\n    <a href="#" ng-click="c.failureAndClose()" ng-if="campaign.data.cancelButton" id="close_link">{{campaign.data.cancelButton}}</a>\n</div>\n<div class=\'privacy-policy\' ng-if="campaign.data.privacy.active">\n    <p ng-show="showPP" ng-if="campaign.data.privacy.tooltip">{{campaign.data.privacy.tooltip}}</p>\n    <a target="_blank" ng-href="{{campaign.data.privacy.url}}" ng-mouseenter="showPP = true" ng-mouseout="showPP = false">{{campaign.data.privacy.text}}</a>\n</div>\n<a ng-if="smallPowered" target="_blank" ng-href="https://go.usabilla.com/powered_by_usabilla?utm_source=campaign&utm_medium=powered-link&utm_content={{campaign.type}}&utm_campaign={{campaign.id}}" title="Powered by Usabilla" class="powered-small"></a>\n<a ng-if="largePowered" target="_blank" ng-href="https://go.usabilla.com/powered_by_usabilla?utm_source=campaign&utm_medium=powered-link&utm_content={{campaign.type}}&utm_campaign={{campaign.id}}" title="Powered by Usabilla" class="powered">Powered by Usabilla</a>\n'),a.put("frontend/views/campaign/base/recruit.html",'<a id="close" role="button" tabindex="0" aria-label="{{closeLabel}}" ng-click="c.failureAndClose()">&times;</a>\n<div id="logo"  title="Survey Logo" role="image" aria-label="logo"></div>\n<h1>{{campaign.data.title}}</h1>\n<p ng-if="!(campaign.data.html && state.allowHtml)" class="nl main">{{ campaign.data.text || \'&nbsp;\' }}</p>\n<p ng-bind-html="campaign.data.text | trustHtml" ng-if="state.allowHtml && campaign.data.html" class="main"></p>\n<div class="button">\n    <a ng-href="{{campaign.data.recruitUrl}}" target="_blank" id="button" ng-click="c.successAndClose()">{{campaign.data.buttonText}}</a>\n    <a href="#" ng-click="c.failureAndClose()" ng-if="campaign.data.cancelButton" id="close_link">{{campaign.data.cancelButton}}</a>\n</div>\n<div class=\'privacy-policy\' ng-if="campaign.data.privacy.active">\n    <p ng-show="showPP" ng-if="campaign.data.privacy.tooltip">{{campaign.data.privacy.tooltip}}</p>\n    <a target="_blank" ng-href="{{campaign.data.privacy.url}}" ng-mouseenter="showPP = true" ng-mouseout="showPP = false">{{campaign.data.privacy.text}}</a>\n</div>\n<a ng-if="smallPowered" target="_blank" ng-href="https://go.usabilla.com/powered_by_usabilla?utm_source=campaign&utm_medium=powered-link&utm_content={{campaign.type}}&utm_campaign={{campaign.id}}" title="Powered by Usabilla" class="powered-small"></a>\n<a ng-if="largePowered" target="_blank" ng-href="https://go.usabilla.com/powered_by_usabilla?utm_source=campaign&utm_medium=powered-link&utm_content={{campaign.type}}&utm_campaign={{campaign.id}}" title="Powered by Usabilla" class="powered">Powered by Usabilla</a>\n'),a.put("frontend/views/campaign/base/boost.html",'<a id="close" role="button" tabindex="0" aria-label="{{closeLabel}}" ng-click="c.failureAndClose();">&times;</a>\n<div id="logo" title="Survey Logo" role="image" aria-label="logo"></div>\n<h1>{{campaign.data.title}}</h1>\n<p ng-if="!(campaign.data.html && state.allowHtml)" class="nl main">{{ campaign.data.text || \'&nbsp;\' }}</p>\n<p ng-bind-html="campaign.data.text | trustHtml" ng-if="state.allowHtml && campaign.data.html" class="main"></p>\n<div class="button">\n    <button id="button" ng-click="c.feedback()">{{campaign.data.buttonText}}</button>\n    <a href="#" ng-click="c.failureAndClose()" ng-if="campaign.data.cancelButton" id="close_link">{{campaign.data.cancelButton}}</a>\n</div>\n<div class=\'privacy-policy\' ng-if="campaign.data.privacy.active">\n    <p ng-show="showPP" ng-if="campaign.data.privacy.tooltip">{{campaign.data.privacy.tooltip}}</p>\n    <a target="_blank" ng-href="{{campaign.data.privacy.url}}" ng-mouseenter="showPP = true" ng-mouseout="showPP = false">{{campaign.data.privacy.text}}</a>\n</div>\n<a ng-if="smallPowered" target="_blank" ng-href="https://go.usabilla.com/powered_by_usabilla?utm_source=campaign&utm_medium=powered-link&utm_content={{campaign.type}}&utm_campaign={{campaign.id}}" title="Powered by Usabilla" class="powered-small"></a>\n<a ng-if="largePowered" target="_blank" ng-href="https://go.usabilla.com/powered_by_usabilla?utm_source=campaign&utm_medium=powered-link&utm_content={{campaign.type}}&utm_campaign={{campaign.id}}" title="Powered by Usabilla" class="powered">Powered by Usabilla</a>\n'),a.put("frontend/views/campaign/base/recruit.html",'<a id="close" role="button" tabindex="0" aria-label="{{closeLabel}}" ng-click="c.failureAndClose()">&times;</a>\n<div id="logo"  title="Survey Logo" role="image" aria-label="logo"></div>\n<h1>{{campaign.data.title}}</h1>\n<p ng-if="!(campaign.data.html && state.allowHtml)" class="nl main">{{ campaign.data.text || \'&nbsp;\' }}</p>\n<p ng-bind-html="campaign.data.text | trustHtml" ng-if="state.allowHtml && campaign.data.html" class="main"></p>\n<div class="button">\n    <a ng-href="{{campaign.data.recruitUrl}}" target="_blank" id="button" ng-click="c.successAndClose()">{{campaign.data.buttonText}}</a>\n    <a href="#" ng-click="c.failureAndClose()" ng-if="campaign.data.cancelButton" id="close_link">{{campaign.data.cancelButton}}</a>\n</div>\n<div class=\'privacy-policy\' ng-if="campaign.data.privacy.active">\n    <p ng-show="showPP" ng-if="campaign.data.privacy.tooltip">{{campaign.data.privacy.tooltip}}</p>\n    <a target="_blank" ng-href="{{campaign.data.privacy.url}}" ng-mouseenter="showPP = true" ng-mouseout="showPP = false">{{campaign.data.privacy.text}}</a>\n</div>\n<a ng-if="smallPowered" target="_blank" ng-href="https://go.usabilla.com/powered_by_usabilla?utm_source=campaign&utm_medium=powered-link&utm_content={{campaign.type}}&utm_campaign={{campaign.id}}" title="Powered by Usabilla" class="powered-small"></a>\n<a ng-if="largePowered" target="_blank" ng-href="https://go.usabilla.com/powered_by_usabilla?utm_source=campaign&utm_medium=powered-link&utm_content={{campaign.type}}&utm_campaign={{campaign.id}}" title="Powered by Usabilla" class="powered">Powered by Usabilla</a>\n')}])},17:function(a,t,e){angular.module("campaign",[]).run(e(29)).factory("CampaignService",e(30)).factory("StateService",e(8)).filter("trustHtml",e(9)).directive("body",e(31)).directive("ubCampaign",e(32)).directive("container",e(33)),e(16)},208:function(a,t,e){e(17)},29:function(a,t){function e(a,t,e){angular.element(t).bind("message",function(t){var e={};try{e=angular.fromJson(t.data)}catch(a){return}angular.isObject(e)&&e.type&&a.$broadcast("$$message."+e.type,e)}),a.$on("campaign.success",function(){e.success()}),a.$on("campaign.page",function(a,t){e.pageSwitch(t||{})})}e.$inject=["$rootScope","$window","CampaignService"],a.exports=e},30:function(a,t){function e(a){for(var t={_previousSize:null,composeMsg:function(a,t){var e={type:a};return JSON.stringify(angular.extend(e,t||{}))},postMsg:function(t,e){a.parent.postMessage(this.composeMsg(t,e),"*")},resize:function(a){angular.equals(a,t._previousSize)||(this.postMsg("resize",a),t._previousSize=a)},pageSwitch:function(a){this.postMsg("pageSwitch",a)},go:function(t){a.open(t,"_blank")}},e=["success","successOnFeedback","failure","close","feedback","markAsClicked","failureAndClose","successAndClose"],n=0;n<e.length;n++)t[e[n]]=function(a){return function(){this.postMsg(a)}}(e[n]);return t}e.$inject=["$window"],a.exports=e},31:function(a,t){function e(a,t,e){return{restrict:"AE",controller:["$rootScope","$attrs","StateService",function(a,t,n){t.$observe("allowHtml",function(a){n.allowHtml="true"===a}),a.$on("form:closeSurvey",function(){e.closeSurvey&&e.closeSurvey()})}],link:function(n,i,o){function c(a){27===a.keyCode&&n.$root.$emit("form:closeSurvey"),n.$evalAsync()}var l=t[0].location.search||"",r=l.match(/(\?|&)tags=([^\&]*)(\&|$)/);a.parent!==a&&r&&(o.$addClass(r[2]),n.position=r[2]),t.on("keydown",c),n.$on("$destroy",function(){t.off("keydown",c)}),o.analyticsUrl&&n.$on("analytics",function(a,t){new Image(1,1).src=o.analyticsUrl+t.e}),n.c=e}}}e.$inject=["$window","$document","CampaignService"],a.exports=e},32:function(a,t){function e(a,t){return{link:function(e,n,i){switch(e.campaign=a(i.ubCampaign)(e),e.campaign.data&&e.campaign.data.showOnce&&t.markAsClicked(),e.campaign.type||"boost"){case"boost":t.successOnFeedback()}}}}e.$inject=["$parse","CampaignService"],a.exports=e},33:function(a,t){function e(a,t){var e="";if(window.getComputedStyle){var n=t.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()});e=getComputedStyle(a).getPropertyValue(n)}else if(a.currentStyle)try{e=a.currentStyle[t]}catch(a){}return isNaN(e)?0:e}function n(a,t,n){return{restrict:"EAC",template:'<div ng-include="campaignTemplate"></div>',controller:["$scope","StateService",function(a,t){a.state=t}],link:function(i,o,c){function l(){p=parseInt(e(o[0],"marginLeft"),10),g=parseInt(e(o[0],"marginRight"),10),d=parseInt(e(o[0],"marginTop"),10),f=parseInt(e(o[0],"marginBottom"),10)}function r(){return!b||b&&document[b]?null:(u&&t.cancel(u),u=t(function(){l();var t={width:o[0].offsetWidth+p+g,height:o[0].offsetHeight+d+f};if(m){Math.abs(m-t.width)<8&&(t.width=m)}switch(m=t.width,i.position||""){case"top":t.margin=f,t.border=parseInt(e(o[0],"borderBottomWidth"),10);break;case"bottom":t.margin=d,t.border=parseInt(e(o[0],"borderTopWidth"),10);break;case"left":t.margin=g,t.border=parseInt(e(o[0],"borderRightWidth"),10);break;case"right":t.margin=p,t.border=parseInt(e(o[0],"borderLeftWidth"),10)}return a.resize(t),null},100,!0),null)}var s={en:"Close feedback form",nl:"Sluit dit formulier",de:"Feedback-Formular schliessen",se:"Stäng feedbackformuläret",fr:"Fermer le formulaire de feedback"},u=null,m=null,p=0,g=0,d=0,f=0,b=void 0;i.attr={},angular.forEach(c,function(a,t){/^ub[A-Z]/.test(t)&&(i.attr[t]=a)}),l(),i.closeLabel=s[navigator.language?navigator.language.substring(0,2):"en"]||s.en,i.smallPowered=!("noSmallPowered"in c),"largePowered"in c&&(i.smallPowered=!1,i.largePowered=!0),i.showClose=!("noClose"in c),i.$watch("campaign.type",function(a){switch(a){case"boost":case"recruit":i.campaignTemplate="frontend/views/campaign/base/"+a+".html";break;case"poll":case"survey":i.campaignTemplate="frontend/views/campaign/form/"+a+".html";break;default:i.campaignTemplate=""}}),b=function(){var a=void 0,e=void 0;if(void 0!==document.hidden?(a="hidden",e="visibilitychange"):void 0!==document.msHidden?(a="msHidden",e="msvisibilitychange"):void 0!==document.webkitHidden&&(a="webkitHidden",e="webkitvisibilitychange"),void 0!==document.addEventListener&&void 0!==a)return document.addEventListener(e,function(){t(function(){r(),t(function(){r()},200)},200)},!1),a}(),i.$on("resize",function(){r()}),angular.element(n).ready(function(){t(function(){r()},200)}),i.$watch("campaign.data.width",function(a){var t=a||200;o[0].style.minWidth=t+"px"});var v=function(){i.$digest()};t(function(){for(var a=angular.element(o).find("img"),t=0;t<a.length;t++){a[t].onload=v}},0)}}}n.$inject=["CampaignService","$timeout","$document"],a.exports=n},8:function(a,t,e){function n(){var a={};return a.allowHtml=!1,a.supportsRange=i(),a}var i=e(15);a.exports=n},9:function(a,t){function e(a){return function(t){return a.trustAsHtml(t)}}e.$inject=["$sce"],a.exports=e}});
//# sourceMappingURL=campaign.js.map
